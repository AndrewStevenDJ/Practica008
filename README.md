# 🎴 PokéCard Dex - Lista Infinita Profesional

![coverage][coverage_badge]
[![style: very good analysis][very_good_analysis_badge]][very_good_analysis_link]
[![License: MIT][license_badge]][license_link]

Una aplicación Flutter de nivel profesional que implementa una lista infinita de cartas Pokémon TCG siguiendo principios de Arquitectura Limpia, patrón BLoC y mejores prácticas de la industria.

Generated by the [Very Good CLI][very_good_cli_link] 🤖

![Flutter](https://img.shields.io/badge/Flutter-02569B?style=flat&logo=flutter&logoColor=white)
![Dart](https://img.shields.io/badge/Dart-0175C2?style=flat&logo=dart&logoColor=white)
![BLoC](https://img.shields.io/badge/BLoC-6C63FF?style=flat)

## ✨ Características

- 📱 **Infinite Scroll**: Paginación automática con throttling optimizado
- 🏗️ **Arquitectura Limpia**: Separación en capas Domain, Data y Presentation
- 🎯 **BLoC Pattern**: Gestión de estado predecible y testeable
- 🔄 **Estado Reactivo**: UI que responde automáticamente a cambios de estado
- 🌐 **API Integration**: Conexión robusta con Pokémon TCG API usando Dio
- ✅ **100% Test Coverage**: Estructura preparada para testing profesional

## 📂 Estructura del Proyecto

```
lib/
├── app/
│   └── view/
│       └── app.dart                    # Configuración principal de la app
├── pokemon_cards/
│   ├── bloc/
│   │   ├── pokemon_card_bloc.dart      # Lógica de negocio
│   │   ├── pokemon_card_event.dart     # Eventos del BLoC
│   │   └── pokemon_card_state.dart     # Estados del BLoC
│   ├── data/
│   │   ├── models/
│   │   │   └── pokemon_card_model.dart # Modelo JSON
│   │   └── repositories/
│   │       └── pokemon_card_repository_impl.dart # Implementación
│   ├── domain/
│   │   ├── entities/
│   │   │   └── pokemon_card.dart       # Entidad de dominio
│   │   └── repositories/
│   │       └── pokemon_card_repository.dart # Contrato
│   ├── view/
│   │   ├── cards_page.dart             # Página con BlocProvider
│   │   └── cards_view.dart             # Vista con UI
│   └── widgets/
│       ├── bottom_loader.dart          # Indicador de carga
│       └── card_list_item.dart         # Item de la lista
```

## 🚀 Comenzando

### Prerequisitos

- Flutter SDK (3.0+)
- Dart SDK (3.0+)
- very_good_cli
- Node.js 18+ (opcional, para Gemini CLI)

---

## Getting Started 🚀

This project contains 3 flavors:

- development
- staging
- production

To run the desired flavor either use the launch configuration in VSCode/Android Studio or use the following commands:

```sh
# Development
$ flutter run --flavor development --target lib/main_development.dart

# Staging
$ flutter run --flavor staging --target lib/main_staging.dart

# Production
$ flutter run --flavor production --target lib/main_production.dart
```

_\*Pokecard Dex works on iOS, Android, Web, and Windows._

---

## Running Tests 🧪

To run all unit and widget tests use the following command:

```sh
$ very_good test --coverage --test-randomize-ordering-seed random
```

To view the generated coverage report you can use [lcov](https://github.com/linux-test-project/lcov).

```sh
# Generate Coverage Report
$ genhtml coverage/lcov.info -o coverage/

# Open Coverage Report
$ open coverage/index.html
```

---

## Working with Translations 🌐

This project relies on [flutter_localizations][flutter_localizations_link] and follows the [official internationalization guide for Flutter][internationalization_link].

### Adding Strings

1. To add a new localizable string, open the `app_en.arb` file at `lib/l10n/arb/app_en.arb`.

```arb
{
    "@@locale": "en",
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    }
}
```

2. Then add a new key/value and description

```arb
{
    "@@locale": "en",
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    },
    "helloWorld": "Hello World",
    "@helloWorld": {
        "description": "Hello World Text"
    }
}
```

3. Use the new string

```dart
import 'package:pokecard_dex/l10n/l10n.dart';

@override
Widget build(BuildContext context) {
  final l10n = context.l10n;
  return Text(l10n.helloWorld);
}
```

### Adding Supported Locales

Update the `CFBundleLocalizations` array in the `Info.plist` at `ios/Runner/Info.plist` to include the new locale.

```xml
    ...

    <key>CFBundleLocalizations</key>
	<array>
		<string>en</string>
		<string>es</string>
	</array>

    ...
```

### Adding Translations

1. For each supported locale, add a new ARB file in `lib/l10n/arb`.

```
├── l10n
│   ├── arb
│   │   ├── app_en.arb
│   │   └── app_es.arb
```

2. Add the translated strings to each `.arb` file:

`app_en.arb`

```arb
{
    "@@locale": "en",
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    }
}
```

`app_es.arb`

```arb
{
    "@@locale": "es",
    "counterAppBarTitle": "Contador",
    "@counterAppBarTitle": {
        "description": "Texto mostrado en la AppBar de la página del contador"
    }
}
```

### Generating Translations

To use the latest translations changes, you will need to generate them:

1. Generate localizations for the current project:

```sh
flutter gen-l10n --arb-dir="lib/l10n/arb"
```

Alternatively, run `flutter run` and code generation will take place automatically.

---

## 🤖 Fase 5: Flujo de Trabajo Profesional con Gemini CLI

### Instalación de Gemini CLI (Opcional)

Si deseas usar el asistente de IA para commits profesionales y refactorización:

```bash
# Instalar Gemini CLI globalmente
npm install -g @google/gemini-cli

# Autenticarte con Google (60 solicitudes/min gratis)
gemini auth

# Instalar la extensión de Flutter
gemini extensions install https://github.com/gemini-cli-extensions/flutter
```

### El Comando `/commit` - Tu Puerta de Calidad de IA

En lugar del flujo tradicional de Git, usa el asistente de IA que automatiza comprobaciones de calidad:

```bash
# 1. Ver archivos modificados
git status

# 2. Preparar cambios
git add .

# 3. Usar el asistente de calidad de IA
gemini
/commit
```

### ¿Qué hace `/commit`?

El comando ejecuta automáticamente esta secuencia de calidad:

1. ✅ **Formateo**: `dart format` y `dart fix`
2. ✅ **Análisis Estático**: `flutter analyze` detecta errores potenciales
3. ✅ **Tests**: `flutter test` verifica que todo funciona
4. ✅ **Mensaje**: Genera un mensaje de commit descriptivo automáticamente
5. ✅ **Revisión**: Te permite editar el mensaje antes de confirmar

Este proceso transforma la IA en un socio de aseguramiento de calidad, no un atajo, sino una herramienta que refuerza hábitos profesionales.

---

## 🎯 Modo Desafío: Expande tu Conocimiento

### 🏆 Desafío 1: Vista de Detalle

**Objetivo**: Implementar navegación a pantalla de detalles de carta.

**Pasos**:
1. Agregar `go_router` al proyecto
2. Definir ruta `/card/:id`
3. Crear `CardDetailPage` con nueva funcionalidad
4. Usar endpoint: `https://api.pokemontcg.io/v2/cards/<id>`
5. Mostrar información completa (ataques, debilidades, resistencias)

**Habilidades**: Navegación, routing, nuevas llamadas API, patrón BLoC extendido

---

### 🔄 Desafío 2: Pull-to-Refresh

**Objetivo**: Permitir refrescar la lista tirando hacia abajo.

**Pasos**:
1. Crear evento `CardsRefreshed` en el BLoC
2. Agregar handler en `PokemonCardBloc` que resetee `_currentPage = 1`
3. Envolver `ListView.builder` en `RefreshIndicator`
4. Conectar `onRefresh` disparando `CardsRefreshed()`

**Habilidades**: Gestión de estado, UX patterns, eventos del BLoC

---

### 🧪 Desafío 3: Testing del BLoC

**Objetivo**: Escribir pruebas unitarias de nivel profesional.

**Pasos**:
1. Crear `test/pokemon_cards/bloc/pokemon_card_bloc_test.dart`
2. Usar `mocktail` para crear mock del repositorio
3. Usar `bloc_test` para verificar comportamiento del BLoC
4. Probar: initial → success con datos
5. Probar: repository error → failure

**Código de ejemplo**:
```dart
import 'package:bloc_test/bloc_test.dart';
import 'package:mocktail/mocktail.dart';
import 'package:test/test.dart';

class MockPokemonCardRepository extends Mock 
    implements PokemonCardRepository {}

void main() {
  group('PokemonCardBloc', () {
    late MockPokemonCardRepository repository;
    
    setUp(() {
      repository = MockPokemonCardRepository();
    });
    
    blocTest<PokemonCardBloc, PokemonCardState>(
      'emits success cuando las cartas se obtienen correctamente',
      build: () {
        when(() => repository.getCards(page: any(named: 'page')))
            .thenAnswer((_) async => [mockCard]);
        return PokemonCardBloc(pokemonCardRepository: repository);
      },
      act: (bloc) => bloc.add(CardsFetched()),
      expect: () => [
        PokemonCardState(
          status: PokemonCardStatus.success,
          cards: [mockCard],
        ),
      ],
    );
  });
}
```

**Habilidades**: Unit testing, mocking, TDD, inversión de dependencias

---

### 🎨 Desafío 4: Refactorización Guiada con IA

**Objetivo**: Mejorar `CardListItem` usando Gemini CLI.

**Usa este prompt**:
```bash
gemini
/modify Cambia el CardListItem para mostrar el HP y el tipo 
de la carta debajo de su nombre con mejor diseño visual.
```

**Observa el proceso**:
- Gemini genera `MODIFICATION_PLAN.md` con plan detallado
- Propone crear una rama Git para aislar el trabajo
- Revisa el plan **antes** de que se escriba código
- Aprende refactorización estructurada y planificada

**Habilidades**: Refactoring, IA como asistente, planificación de cambios

---

### 🔍 Desafío 5: Búsqueda por Nombre

**Objetivo**: Agregar barra de búsqueda en el AppBar.

**Implementación sugerida**:

1. **Nuevo Evento**:
```dart
final class CardsSearched extends PokemonCardEvent {
  const CardsSearched(this.query);
  final String query;
  
  @override
  List<Object> get props => [query];
}
```

2. **Actualizar Estado**:
```dart
final class PokemonCardState extends Equatable {
  const PokemonCardState({
    // ... campos existentes
    this.searchQuery = '',
  });
  
  final String searchQuery;
}
```

3. **Handler en BLoC**: Resetear página y buscar
4. **UI**: `TextField` en `AppBar` que dispara evento
5. **API**: Usar query parameter `q=name:pikachu*`

**Habilidades**: API avanzada, nuevos eventos, formularios, debouncing

---

### 🎭 Desafío 6: Filtrado Avanzado por Tipo

**Objetivo**: Implementar filtro por tipo con Drawer.

**Implementación sugerida**:

1. **Estado**: Agregar `Set<String> activeFilters` en `PokemonCardState`
2. **Evento**: `FilterChanged(Set<String> filters)`
3. **UI**: `Drawer` con `CheckboxListTile` para cada tipo Pokémon
4. **API**: Query dinámico `q=types:(fire OR water OR grass)`
5. **BLoC**: Limpiar lista y refetch con filtros aplicados

**Tipos sugeridos**: Fire, Water, Grass, Electric, Psychic, Fighting, Colorless

**Habilidades**: UI compleja, estado avanzado, queries dinámicos, Drawer

---

## 🎓 Arquitectura y Principios

Este proyecto demuestra:

- ✅ **Arquitectura Limpia** con separación clara de responsabilidades
- ✅ **SOLID Principles** aplicados (especialmente D - Dependency Inversion)
- ✅ **Testeable** por diseño (BLoC depende de abstracciones)
- ✅ **Escalable** con estructura feature-first
- ✅ **Mantenible** con código autodocumentado y separación de capas

### Flujo de Datos Completo

```
Usuario hace scroll
    ↓
ScrollController detecta posición
    ↓
Dispara evento CardsFetched
    ↓
PokemonCardBloc recibe evento
    ↓
Llama a PokemonCardRepository.getCards()
    ↓
PokemonCardRepositoryImpl hace petición HTTP con Dio
    ↓
API Pokémon TCG responde con JSON
    ↓
PokemonCardModel.fromJson() parsea respuesta
    ↓
toEntity() convierte Model → Entity
    ↓
BLoC emite nuevo PokemonCardState con cartas
    ↓
BlocBuilder escucha y reconstruye UI
    ↓
ListView.builder renderiza nuevas cartas
```

---

## 📚 Recursos Adicionales

- [Pokémon TCG API Documentation](https://docs.pokemontcg.io/)
- [BLoC Library Official Docs](https://bloclibrary.dev/)
- [Flutter Clean Architecture Guide](https://resocoder.com/flutter-clean-architecture-tdd/)
- [Very Good CLI Documentation](https://cli.vgv.dev/)
- [Gemini CLI GitHub](https://github.com/google/generative-ai-cli)
- [Flutter Testing Guide](https://docs.flutter.dev/testing)

---

## 🎯 Checklist de Calidad Profesional

Antes de considerar el proyecto "completo":

- [ ] **Tests**: Cobertura mínima del 80% (idealmente 100%)
- [ ] **Icono**: Personalizado para la aplicación
- [ ] **Splash Screen**: Diseño coherente con la marca
- [ ] **Documentación**: README completo (este archivo)
- [ ] **Git**: Historial limpio con commits descriptivos
- [ ] **CI/CD**: GitHub Actions funcionando correctamente
- [ ] **Análisis**: `flutter analyze` sin warnings críticos
- [ ] **Performance**: Sin jank en scroll infinito
- [ ] **Accesibilidad**: Textos semánticos y contraste adecuado

---

## 📝 Nota Final

> **Importante**: Este proyecto es más que una app funcional. Es una demostración de ingeniería de software profesional. La arquitectura limpia, el patrón BLoC, y el flujo de trabajo con IA no son solo "features técnicas", son las habilidades fundamentales que distinguen a un desarrollador junior de un ingeniero senior. Practica estos patrones, entiende el "por qué" detrás de cada decisión arquitectónica, y estarás preparado para proyectos de producción reales.

---

## 🎉 Conclusión

Al completar este proyecto, has:

- ✅ Construido una app con arquitectura escalable
- ✅ Implementado gestión de estado profesional con BLoC
- ✅ Aplicado principios SOLID y Clean Architecture
- ✅ Integrado APIs externas de forma robusta
- ✅ Aprendido flujo de trabajo asistido por IA
- ✅ Creado código testeable y mantenible

**¡Felicidades! Ahora tienes las bases para convertirte en un Flutter Engineer profesional.** 🚀

---

**Desarrollado con 💙 siguiendo principios de ingeniería de software de nivel senior**

---

[coverage_badge]: coverage_badge.svg
[flutter_localizations_link]: https://api.flutter.dev/flutter/flutter_localizations/flutter_localizations-library.html
[internationalization_link]: https://flutter.dev/docs/development/accessibility-and-localization/internationalization
[license_badge]: https://img.shields.io/badge/license-MIT-blue.svg
[license_link]: https://opensource.org/licenses/MIT
[very_good_analysis_badge]: https://img.shields.io/badge/style-very_good_analysis-B22C89.svg
[very_good_analysis_link]: https://pub.dev/packages/very_good_analysis
[very_good_cli_link]: https://github.com/VeryGoodOpenSource/very_good_cli
